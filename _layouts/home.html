<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{{ page.title }} | {{ site.title }}</title>
    {%- seo -%}
    <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">
    <link rel="alternate" type="application/atom+xml" title="{{ site.title }}" href="{{ '/feed.xml' | relative_url }}">
  </head>
  <body class="home">
    {% if page.show_header != false %}
    <header class="site-header">
      <div class="container">
        <h1 class="site-title"><a href="{{ '/' | relative_url }}">{{ site.title }}</a></h1>
        <p class="site-tagline">{{ site.description }}</p>
      </div>
    </header>
    {% endif %}

    {% include navigation.html %}

    <!-- Intro card (name, about, headshot, optional contacts) -->
    <section class="container">
      <article class="intro">
        <div class="intro__text">
          <h1 class="intro__title">{{ page.heading | default: site.author.name }}</h1>
          <p class="intro__blurb">
            {{ page.about_blurb | default: "Economics graduate student at UC Davis ‚Äî research, code, and notes." }}
          </p>

          {% if page.show_contacts != false %}
          <ul class="intro__contacts">
            {% if site.author.email %}
              <li><strong>Email:</strong> <a href="mailto:{{ site.author.email }}">{{ site.author.email }}</a></li>
            {% endif %}
            {% if page.location %}<li><strong>Location:</strong> {{ page.location }}</li>{% endif %}
            {% if page.links %}
              {% if page.links.github %}<li><strong>GitHub:</strong> <a href="{{ page.links.github }}" target="_blank" rel="noopener">{{ page.links.github | replace: 'https://','' }}</a></li>{% endif %}
              {% if page.links.scholar %}<li><strong>Scholar:</strong> <a href="{{ page.links.scholar }}" target="_blank" rel="noopener">Google Scholar</a></li>{% endif %}
              {% if page.links.linkedin %}<li><strong>LinkedIn:</strong> <a href="{{ page.links.linkedin }}" target="_blank" rel="noopener">{{ page.links.linkedin | replace: 'https://','' }}</a></li>{% endif %}
            {% endif %}
          </ul>
          {% endif %}

          <div class="intro__actions">
            <a class="btn btn--primary" href="{{ '/my-work/' | relative_url }}">My Work</a>
            <a class="btn btn--ghost" href="{{ '/cv/' | relative_url }}">CV</a>
          </div>
        </div>

        {% if page.avatar %}
        <div class="intro__image">
          <img src="{{ page.avatar | relative_url }}" alt="{{ site.author.name }}">
        </div>
        {% endif %}
      </article>
    </section>

    {% assign project_count = site.projects | size %}
    {% if page.show_featured != false and project_count > 0 %}
    <section class="container">
      <h2 class="section-title">Featured Work</h2>
      <ul class="cards">
        {% assign items = site.projects | sort:"year" | reverse | slice: 0, 6 %}
        {% for p in items %}
          <li class="card">
            <a href="{{ p.url | relative_url }}" class="card__link">
              {% if p.thumbnail %}
                <img src="{{ p.thumbnail | relative_url }}" alt="" class="card__thumb">
              {% endif %}
              <div class="card__body">
                <h3 class="card__title">{{ p.title }}</h3>
                <p class="card__meta">
                  {% if p.year %}{{ p.year }}{% endif %}
                  {% if p.tags %} ‚Ä¢ {{ p.tags | join: ', ' }}{% endif %}
                </p>
                {% if p.summary %}<p class="card__summary">{{ p.summary }}</p>{% endif %}
              </div>
            </a>
          </li>
        {% endfor %}
      </ul>
    </section>
    {% endif %}

    <footer class="site-footer">
      <div class="container">
        <p>&copy; {{ site.time | date: '%Y' }} {{ site.author.name }}</p>
      </div>
    </footer>
    <script>
(function () {
  const KEY = 'theme';
  const root = document.documentElement;
  const btn  = document.getElementById('theme-toggle');

  // Prefer saved value, otherwise system preference
  const saved = localStorage.getItem(KEY);
  const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
  const initial = saved || (prefersDark ? 'dark' : 'light');
  root.setAttribute('data-theme', initial);

  function setIcon() {
    if (!btn) return;
    const isDark = root.getAttribute('data-theme') === 'dark';
    btn.textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
    btn.title = isDark ? 'Switch to light mode' : 'Switch to dark mode';
  }
  setIcon();

  if (btn) {
    btn.addEventListener('click', function () {
      const next = root.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
      root.setAttribute('data-theme', next);
      localStorage.setItem(KEY, next);
      setIcon();
    });
  }
})();
</script>
  </body>
</html>
